<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Dunder Deep Dive</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .code-font { font-family: 'JetBrains Mono', monospace; }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 300px;
            margin: 0 auto;
        }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .transition-all { transition: all 0.3s ease; }
        
        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 8px; height: 8px; }
        .custom-scroll::-webkit-scrollbar-track { background: #1e293b; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #64748b; }

        .active-tab { border-bottom: 2px solid #3b82f6; color: #1d4ed8; font-weight: 600; }
        .inactive-tab { color: #64748b; }
        .inactive-tab:hover { color: #334155; }
    </style>
    <!-- Chosen Palette: Slate & Blue (Modern Tech/Documentation) -->
    <!-- Application Structure Plan: Bilingual Support Added. 
         Structure remains: Header -> Nav (with Lang Toggle) -> Dynamic Views -> Footer.
         Data structure updated to support {id, en} keys. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="text-slate-800">

    <!-- Navbar -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center gap-4">
                    <span class="text-2xl font-bold text-slate-800 tracking-tight cursor-pointer" onclick="app.navigate('intro')">üêç Python<span class="text-blue-600">Dunder</span>Dive</span>
                </div>
                
                <div class="flex items-center gap-4">
                    <!-- Desktop Nav -->
                    <div class="hidden sm:flex space-x-8 items-center" id="nav-container">
                        <!-- Nav items injected by JS -->
                    </div>
                    
                    <!-- Language Switcher -->
                    <button onclick="app.toggleLang()" class="flex items-center gap-1 px-3 py-1 bg-slate-100 hover:bg-slate-200 rounded-full text-sm font-bold text-slate-700 transition-colors border border-slate-300">
                        <span id="lang-indicator">üáÆüá© ID</span>
                    </button>

                    <!-- Mobile menu button -->
                    <div class="flex items-center sm:hidden">
                        <button id="mobile-menu-btn" class="text-slate-500 hover:text-slate-700 font-bold text-xl">‚ò∞</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden sm:hidden bg-white border-b border-slate-200 p-4 space-y-2"></div>
    </nav>

    <!-- Main Content Area -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 min-h-screen">
        
        <!-- View: Introduction -->
        <div id="view-intro" class="space-y-8 animate-fade-in">
            <div class="text-center max-w-3xl mx-auto mb-12">
                <h1 class="text-4xl font-bold text-slate-900 mb-4" data-i18n="hero_title"></h1>
                <p class="text-lg text-slate-600 leading-relaxed" data-i18n="hero_desc"></p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <h2 class="text-xl font-bold mb-4 flex items-center gap-2" data-i18n="mech_title"></h2>
                    <p class="text-slate-600 mb-4" data-i18n="mech_desc"></p>
                    <div class="bg-slate-900 rounded-lg p-4 text-sm text-slate-300 code-font overflow-x-auto custom-scroll">
                        <div class="flex items-center gap-4 mb-2">
                            <span class="text-green-400">User Code</span>
                            <span class="text-slate-500">‚ûú</span>
                            <span class="text-blue-400">Python Internal</span>
                        </div>
                        <div class="border-t border-slate-700 pt-2 space-y-2">
                            <div class="flex justify-between"><span>len(obj)</span> <span class="text-pink-400">obj.__len__()</span></div>
                            <div class="flex justify-between"><span>obj[key]</span> <span class="text-pink-400">obj.__getitem__(key)</span></div>
                            <div class="flex justify-between"><span>str(obj)</span> <span class="text-pink-400">obj.__str__()</span></div>
                            <div class="flex justify-between"><span>a == b</span> <span class="text-pink-400">a.__eq__(b)</span></div>
                        </div>
                    </div>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200 flex flex-col justify-center">
                    <h2 class="text-xl font-bold mb-4" data-i18n="why_title"></h2>
                    <div class="chart-container">
                        <canvas id="introChart"></canvas>
                    </div>
                    <p class="text-sm text-center text-slate-500 mt-2" data-i18n="why_caption"></p>
                </div>
            </div>

            <div class="text-center">
                <button onclick="app.navigate('categories')" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-full transition-all shadow-lg hover:shadow-blue-500/30" data-i18n="cta_start">
                </button>
            </div>
        </div>

        <!-- View: Categories -->
        <div id="view-categories" class="hidden space-y-6">
            <div class="mb-6">
                <h2 class="text-3xl font-bold text-slate-900" data-i18n="cat_title"></h2>
                <p class="text-slate-600" data-i18n="cat_desc"></p>
            </div>

            <!-- Filter Tabs -->
            <div class="flex flex-wrap gap-2 mb-6" id="category-filters">
                <!-- Injected by JS -->
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Method List -->
                <div class="lg:col-span-1 space-y-3" id="method-list">
                    <!-- Cards injected by JS -->
                </div>

                <!-- Method Detail View -->
                <div class="lg:col-span-2">
                    <div id="method-detail" class="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden sticky top-24">
                        <div class="p-8 text-center text-slate-400 py-20">
                            <span class="text-6xl block mb-4">üëà</span>
                            <span data-i18n="cat_placeholder"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- View: Interactive Lab -->
        <div id="view-lab" class="hidden space-y-6">
            <div class="mb-8 text-center">
                <h2 class="text-3xl font-bold text-slate-900" data-i18n="lab_title"></h2>
                <p class="text-slate-600" data-i18n="lab_desc"></p>
            </div>

            <div class="bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden max-w-4xl mx-auto">
                <!-- Lab Toolbar -->
                <div class="bg-slate-100 p-4 border-b border-slate-200 flex flex-wrap gap-4 justify-center" id="lab-controls">
                    <!-- Buttons injected by JS -->
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2">
                    <!-- Code Editor Simulation -->
                    <div class="bg-slate-900 p-6 text-slate-100 code-font text-sm overflow-hidden relative">
                        <div class="absolute top-2 right-2 text-xs text-slate-500">script.py</div>
                        <div id="lab-code-display" class="space-y-1 min-h-[300px]">
                            <span class="text-slate-500"># ...</span>
                        </div>
                    </div>

                    <!-- Output & Analysis -->
                    <div class="bg-slate-50 p-6 border-l border-slate-200 flex flex-col">
                        <div class="mb-4">
                            <h3 class="text-xs font-bold uppercase tracking-wider text-slate-500 mb-2">Terminal Output</h3>
                            <div id="lab-output" class="bg-black text-green-400 code-font p-3 rounded text-sm h-24 overflow-y-auto custom-scroll">
                                >_
                            </div>
                        </div>
                        <div class="flex-1 bg-blue-50 border border-blue-100 rounded p-4">
                            <h3 class="text-xs font-bold uppercase tracking-wider text-blue-600 mb-2" data-i18n="lab_analysis_title"></h3>
                            <p id="lab-explanation" class="text-sm text-slate-700 leading-relaxed">
                                ...
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- View: Analytics -->
        <div id="view-analytics" class="hidden space-y-8">
             <div class="mb-6">
                <h2 class="text-3xl font-bold text-slate-900" data-i18n="ana_title"></h2>
                <p class="text-slate-600" data-i18n="ana_desc"></p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Usage Frequency Chart -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <h3 class="text-lg font-bold mb-4 text-slate-800" data-i18n="ana_freq_title"></h3>
                    <p class="text-sm text-slate-500 mb-4" data-i18n="ana_freq_desc"></p>
                    <div class="chart-container">
                        <canvas id="usageChart"></canvas>
                    </div>
                </div>

                <!-- Complexity Radar -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                    <h3 class="text-lg font-bold mb-4 text-slate-800" data-i18n="ana_radar_title"></h3>
                    <p class="text-sm text-slate-500 mb-4" data-i18n="ana_radar_desc"></p>
                    <div class="chart-container">
                        <canvas id="radarChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-6">
                <h3 class="text-lg font-bold text-yellow-800 mb-2" data-i18n="ana_insight_title"></h3>
                <ul class="list-disc list-inside text-yellow-900 space-y-2" id="insight-list">
                    <!-- Injected by JS -->
                </ul>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-slate-200 mt-12 py-8">
        <div class="max-w-7xl mx-auto px-4 text-center text-slate-500 text-sm">
            <p>Made with Tailwind CSS & Chart.js.</p>
            <p class="mt-2">No real magic, just <code class="bg-slate-100 px-1 rounded text-slate-700">obj.__class__</code>.</p>
        </div>
    </footer>

    <script>
        // --- TRANSLATIONS (STATIC UI) ---
        const translations = {
            id: {
                nav_intro: "Pengantar",
                nav_cat: "Kategori Dunder",
                nav_lab: "Lab Koding",
                nav_analysis: "Analisis Data",
                hero_title: "Mengungkap Sihir di Balik Python",
                hero_desc: "Python Dunder Methods (<i>Double Underscore</i>), juga dikenal sebagai <b>Magic Methods</b>, adalah cara Python memungkinkan objek buatan Anda berperilaku seperti tipe data bawaan (seperti list atau angka). Aplikasi ini membedah cara kerjanya.",
                mech_title: "‚öôÔ∏è Mekanisme Internal",
                mech_desc: "Saat Anda mengetik <code class='bg-slate-100 px-1 rounded text-blue-600 code-font'>x + y</code>, Python sebenarnya memanggil <code class='bg-slate-100 px-1 rounded text-pink-600 code-font'>x.__add__(y)</code>. Ini disebut <i>Operator Overloading</i>.",
                why_title: "üìä Mengapa Penting?",
                why_caption: "Dampak penggunaan Dunder Methods pada kualitas kode",
                cta_start: "Mulai Eksplorasi Kategori ‚ûú",
                cat_title: "Katalog Magic Methods",
                cat_desc: "Pilih kategori untuk melihat metode spesifik dan penggunaannya.",
                cat_all: "Semua",
                cat_placeholder: "Pilih metode di sebelah kiri untuk melihat detail mendalam.",
                lab_title: "Laboratorium Dunder",
                lab_desc: "Simulasikan interaksi objek Python dan lihat apa yang terjadi di belakang layar.",
                lab_analysis_title: "Analisis Dunder",
                lab_waiting: "Belum ada aksi yang dipilih.",
                lab_processing: "Memproses...",
                lab_done: ">_ Perintah dieksekusi.",
                ana_title: "Analisis Meta Dunder",
                ana_desc: "Statistik penggunaan dan pengelompokan metode berdasarkan karakteristiknya.",
                ana_freq_title: "Frekuensi Penggunaan (Proyek Nyata)",
                ana_freq_desc: "Seberapa sering metode ini diimplementasikan secara manual dalam class custom.",
                ana_radar_title: "Peta Karakteristik Metode",
                ana_radar_desc: "Perbandingan antara utilitas (kegunaan) dan kompleksitas implementasi.",
                ana_insight_title: "üí° Insight Analis",
                // Chart Labels
                lbl_readability: "Keterbacaan",
                lbl_flexibility: "Fleksibilitas",
                lbl_compatibility: "Kompatibilitas Native",
                lbl_score: "Skor Peningkatan",
                lbl_freq: "Frekuensi (%)",
                lbl_complexity: "Kompleksitas",
                lbl_utility: "Utilitas Harian"
            },
            en: {
                nav_intro: "Introduction",
                nav_cat: "Dunder Categories",
                nav_lab: "Code Lab",
                nav_analysis: "Data Analysis",
                hero_title: "Unveiling the Magic Behind Python",
                hero_desc: "Python Dunder Methods (<i>Double Underscore</i>), also known as <b>Magic Methods</b>, are how Python allows your custom objects to behave like built-in types (like lists or numbers). This app dissects how they work.",
                mech_title: "‚öôÔ∏è Internal Mechanism",
                mech_desc: "When you type <code class='bg-slate-100 px-1 rounded text-blue-600 code-font'>x + y</code>, Python actually calls <code class='bg-slate-100 px-1 rounded text-pink-600 code-font'>x.__add__(y)</code>. This is called <i>Operator Overloading</i>.",
                why_title: "üìä Why it Matters?",
                why_caption: "Impact of Dunder Methods on code quality",
                cta_start: "Start Exploring Categories ‚ûú",
                cat_title: "Magic Methods Catalog",
                cat_desc: "Select a category to view specific methods and usage.",
                cat_all: "All",
                cat_placeholder: "Select a method on the left to view deep details.",
                lab_title: "Dunder Lab",
                lab_desc: "Simulate Python object interactions and see what happens behind the scenes.",
                lab_analysis_title: "Dunder Analysis",
                lab_waiting: "No action selected yet.",
                lab_processing: "Processing...",
                lab_done: ">_ Command executed.",
                ana_title: "Meta Dunder Analysis",
                ana_desc: "Usage statistics and method grouping based on characteristics.",
                ana_freq_title: "Usage Frequency (Real-world Projects)",
                ana_freq_desc: "How often these methods are manually implemented in custom classes.",
                ana_radar_title: "Method Characteristic Map",
                ana_radar_desc: "Comparison between utility (usefulness) and implementation complexity.",
                ana_insight_title: "üí° Analyst Insights",
                // Chart Labels
                lbl_readability: "Readability",
                lbl_flexibility: "Flexibility",
                lbl_compatibility: "Native Compatibility",
                lbl_score: "Improvement Score",
                lbl_freq: "Frequency (%)",
                lbl_complexity: "Complexity",
                lbl_utility: "Daily Utility"
            }
        };

        // --- DATA STORE (BILINGUAL) ---
        const dunderData = {
            categories: [
                { id: 'init', name: { id: 'Inisialisasi & Representasi', en: 'Initialization & Representation' }, icon: 'üèóÔ∏è' },
                { id: 'arithmetic', name: { id: 'Aritmatika', en: 'Arithmetic' }, icon: 'üßÆ' },
                { id: 'comparison', name: { id: 'Perbandingan', en: 'Comparison' }, icon: '‚öñÔ∏è' },
                { id: 'container', name: { id: 'Wadah & Urutan', en: 'Containers & Sequences' }, icon: 'üì¶' },
                { id: 'context', name: { id: 'Manajemen Konteks', en: 'Context Management' }, icon: 'üö™' }
            ],
            methods: [
                {
                    name: '__init__',
                    args: '(self, ...)',
                    category: 'init',
                    desc: { 
                        id: 'Konstruktor objek. Dipanggil saat instance baru dibuat.', 
                        en: 'Object constructor. Called when a new instance is created.' 
                    },
                    example: 'class Cat:\n    def __init__(self, name):\n        self.name = name',
                    usage: 'my_cat = Cat("Luna")',
                    tips: { 
                        id: 'Gunakan untuk mengatur atribut awal.', 
                        en: 'Use to set up initial attributes.' 
                    }
                },
                {
                    name: '__repr__',
                    args: '(self)',
                    category: 'init',
                    desc: { 
                        id: 'Representasi string "resmi". Harus tidak ambigu, idealnya berupa kode Python yang valid.', 
                        en: '"Official" string representation. Should be unambiguous, ideally valid Python code.' 
                    },
                    example: 'def __repr__(self):\n    return f"Cat(name=\'{self.name}\')"',
                    usage: 'repr(my_cat)  # Output: "Cat(name=\'Luna\')"',
                    tips: { 
                        id: 'Sangat penting untuk debugging. Ditampilkan di console.', 
                        en: 'Crucial for debugging. Shown in console/shell.' 
                    }
                },
                {
                    name: '__str__',
                    args: '(self)',
                    category: 'init',
                    desc: { 
                        id: 'Representasi string yang "mudah dibaca" oleh pengguna akhir.', 
                        en: '"Readable" string representation for end-users.' 
                    },
                    example: 'def __str__(self):\n    return f"Kucing bernama {self.name}"',
                    usage: 'print(my_cat) # Output: "Kucing bernama Luna"',
                    tips: { 
                        id: 'Jika __str__ tidak ada, Python akan menggunakan __repr__.', 
                        en: 'If __str__ is missing, Python falls back to __repr__.' 
                    }
                },
                {
                    name: '__add__',
                    args: '(self, other)',
                    category: 'arithmetic',
                    desc: { 
                        id: 'Menangani operator penjumlahan (+).', 
                        en: 'Handles the addition operator (+).' 
                    },
                    example: 'def __add__(self, other):\n    return self.value + other.value',
                    usage: 'obj1 + obj2',
                    tips: { 
                        id: 'Jangan lupa implementasikan __radd__ untuk penjumlahan terbalik.', 
                        en: 'Don\'t forget __radd__ for reverse addition.' 
                    }
                },
                {
                    name: '__eq__',
                    args: '(self, other)',
                    category: 'comparison',
                    desc: { 
                        id: 'Menangani operator kesetaraan (==).', 
                        en: 'Handles the equality operator (==).' 
                    },
                    example: 'def __eq__(self, other):\n    return self.id == other.id',
                    usage: 'obj1 == obj2',
                    tips: { 
                        id: 'Secara default, Python membandingkan identitas memori (is), bukan nilai.', 
                        en: 'By default, Python compares memory identity (is), not value.' 
                    }
                },
                {
                    name: '__len__',
                    args: '(self)',
                    category: 'container',
                    desc: { 
                        id: 'Mengembalikan panjang objek. Digunakan oleh fungsi len().', 
                        en: 'Returns object length. Used by built-in len().' 
                    },
                    example: 'def __len__(self):\n    return len(self.items)',
                    usage: 'len(my_object)',
                    tips: { 
                        id: 'Harus mengembalikan integer >= 0.', 
                        en: 'Must return an integer >= 0.' 
                    }
                },
                {
                    name: '__getitem__',
                    args: '(self, key)',
                    category: 'container',
                    desc: { 
                        id: 'Mengambil item berdasarkan indeks atau key. Membuat objek bisa diakses seperti list atau dict.', 
                        en: 'Get item by index or key. Makes objects accessible like lists or dicts.' 
                    },
                    example: 'def __getitem__(self, index):\n    return self.data[index]',
                    usage: 'val = obj["key"] or val = obj[0]',
                    tips: { 
                        id: 'Juga memungkinkan iterasi (for loop) jika __iter__ tidak didefinisikan.', 
                        en: 'Also allows iteration (for loop) if __iter__ is missing.' 
                    }
                },
                {
                    name: '__enter__',
                    args: '(self)',
                    category: 'context',
                    desc: { 
                        id: 'Dipanggil saat memasuki blok "with".', 
                        en: 'Called when entering a "with" block.' 
                    },
                    example: 'def __enter__(self):\n    print("Membuka resource...")\n    return self',
                    usage: 'with MyManager() as m:',
                    tips: { 
                        id: 'Sering digunakan untuk membuka file atau koneksi database.', 
                        en: 'Often used to open files or database connections.' 
                    }
                },
                {
                    name: '__exit__',
                    args: '(self, exc_type, ...)',
                    category: 'context',
                    desc: { 
                        id: 'Dipanggil saat keluar dari blok "with", bahkan jika terjadi error.', 
                        en: 'Called when exiting a "with" block, even if an error occurs.' 
                    },
                    example: 'def __exit__(self, exc_type, ...):\n    print("Menutup resource...")',
                    usage: '# Auto-called at end of block',
                    tips: { 
                        id: 'Tempat untuk cleanup resource.', 
                        en: 'The place for resource cleanup.' 
                    }
                }
            ],
            labScenarios: [
                {
                    id: 'create',
                    label: { id: 'Instansiasi Objek', en: 'Object Instantiation' },
                    code: 'kucing = Hewan("Mochi")',
                    internal: 'Hewan.__init__(kucing, "Mochi")',
                    desc: { 
                        id: 'Python membuat objek kosong di memori, lalu memanggil __init__ untuk mengisi atributnya.', 
                        en: 'Python creates a blank object in memory, then calls __init__ to populate attributes.' 
                    }
                },
                {
                    id: 'print',
                    label: { id: 'Print Objek', en: 'Print Object' },
                    code: 'print(kucing)',
                    internal: 'sys.stdout.write(kucing.__str__() + "\\n")',
                    desc: { 
                        id: 'Fungsi print() mencari __str__. Jika tidak ada, ia mencari __repr__.', 
                        en: 'The print() function looks for __str__. If missing, it looks for __repr__.' 
                    }
                },
                {
                    id: 'add',
                    label: { id: 'Penjumlahan (+)', en: 'Addition (+)' },
                    code: 'total = dompet1 + dompet2',
                    internal: 'total = dompet1.__add__(dompet2)',
                    desc: { 
                        id: 'Operator + hanyalah syntax sugar untuk pemanggilan method __add__ pada operand kiri.', 
                        en: 'The + operator is just syntax sugar for calling the __add__ method on the left operand.' 
                    }
                },
                {
                    id: 'index',
                    label: { id: 'Akses Index []', en: 'Index Access []' },
                    code: 'item = rak_buku[5]',
                    internal: 'item = rak_buku.__getitem__(5)',
                    desc: { 
                        id: 'Kurung siku [] diterjemahkan langsung menjadi __getitem__ dengan isi kurung sebagai argumen.', 
                        en: 'Square brackets [] translate directly to __getitem__ with the bracket content as arguments.' 
                    }
                }
            ],
            insights: [
                { id: "<strong>__init__</strong> adalah raja tak terbantahkan, hampir setiap class membutuhkannya.", en: "<strong>__init__</strong> is the undisputed king, almost every class needs it." },
                { id: "<strong>__str__</strong> dan <strong>__repr__</strong> sangat krusial untuk debugging.", en: "<strong>__str__</strong> and <strong>__repr__</strong> are crucial for debugging." },
                { id: "Metode aritmatika (seperti <strong>__add__</strong>) jarang digunakan kecuali untuk tipe data matematis.", en: "Arithmetic methods (like <strong>__add__</strong>) are rare unless building math types." },
                { id: "Memahami <strong>__len__</strong> dan <strong>__getitem__</strong> membuat objek terasa \"Pythonic\".", en: "Understanding <strong>__len__</strong> and <strong>__getitem__</strong> makes objects feel \"Pythonic\"." }
            ]
        };

        // --- APP STATE ---
        const app = {
            currentView: 'intro',
            currentCategory: 'all',
            lang: 'id', // Default language
            charts: {},
            
            init() {
                this.updateStaticContent();
                this.renderNav();
                this.renderCategories();
                this.renderLab();
                this.renderInsights();
                this.initCharts();
                this.navigate('intro');
                
                // Mobile menu logic
                document.getElementById('mobile-menu-btn').addEventListener('click', () => {
                    const menu = document.getElementById('mobile-menu');
                    menu.classList.toggle('hidden');
                });
            },

            // Helper to get text based on current lang
            t(keyOrObj) {
                if (typeof keyOrObj === 'object') {
                    return keyOrObj[this.lang] || keyOrObj['en'];
                }
                return translations[this.lang][keyOrObj] || keyOrObj;
            },

            toggleLang() {
                this.lang = this.lang === 'id' ? 'en' : 'id';
                document.getElementById('lang-indicator').innerText = this.lang === 'id' ? 'üáÆüá© ID' : 'üá∫üá∏ EN';
                
                // Re-render everything
                this.updateStaticContent();
                this.renderNav();
                this.renderCategories();
                this.renderLab();
                this.renderInsights();
                this.initCharts(); // Re-init charts to update labels
                
                // If detail view is open, refresh it
                const detailContainer = document.getElementById('method-detail');
                if (detailContainer.querySelector('h3')) {
                     // Check if a method is currently selected by looking at the title
                     const currentMethodName = detailContainer.querySelector('h3').innerText;
                     this.showMethodDetail(currentMethodName);
                }
            },

            updateStaticContent() {
                document.querySelectorAll('[data-i18n]').forEach(el => {
                    const key = el.dataset.i18n;
                    el.innerHTML = this.t(key);
                });
            },

            navigate(viewId) {
                ['intro', 'categories', 'lab', 'analytics'].forEach(id => {
                    document.getElementById(`view-${id}`).classList.add('hidden');
                });
                document.getElementById(`view-${viewId}`).classList.remove('hidden');
                
                document.querySelectorAll('.nav-link').forEach(el => {
                    if(el.dataset.target === viewId) {
                        el.classList.add('active-tab');
                        el.classList.remove('inactive-tab');
                    } else {
                        el.classList.remove('active-tab');
                        el.classList.add('inactive-tab');
                    }
                });
                this.currentView = viewId;
                window.scrollTo(0, 0);
            },

            renderNav() {
                const container = document.getElementById('nav-container');
                const mobileContainer = document.getElementById('mobile-menu');
                const items = [
                    { id: 'intro', label: 'nav_intro' },
                    { id: 'categories', label: 'nav_cat' },
                    { id: 'lab', label: 'nav_lab' },
                    { id: 'analytics', label: 'nav_analysis' }
                ];

                const html = items.map(item => 
                    `<button data-target="${item.id}" onclick="app.navigate('${item.id}')" class="nav-link text-sm font-medium transition-colors duration-200 py-1">
                        ${this.t(item.label)}
                    </button>`
                ).join('');

                container.innerHTML = html;
                
                mobileContainer.innerHTML = items.map(item => 
                    `<button onclick="app.navigate('${item.id}'); document.getElementById('mobile-menu').classList.add('hidden')" class="block w-full text-left px-4 py-2 text-slate-700 hover:bg-slate-100 rounded">
                        ${this.t(item.label)}
                    </button>`
                ).join('');
            },

            renderCategories() {
                const filterContainer = document.getElementById('category-filters');
                let filterHtml = `<button onclick="app.filterCategory('all')" class="cat-filter px-4 py-2 rounded-full text-sm font-bold bg-slate-800 text-white shadow transition-all" data-cat="all">${this.t('cat_all')}</button>`;
                
                dunderData.categories.forEach(cat => {
                    filterHtml += `<button onclick="app.filterCategory('${cat.id}')" class="cat-filter px-4 py-2 rounded-full text-sm font-medium bg-white text-slate-600 border border-slate-200 hover:bg-slate-50 transition-all" data-cat="${cat.id}">${cat.icon} ${this.t(cat.name)}</button>`;
                });
                filterContainer.innerHTML = filterHtml;

                this.filterCategory(this.currentCategory);
            },

            filterCategory(catId) {
                this.currentCategory = catId;
                document.querySelectorAll('.cat-filter').forEach(btn => {
                    if(btn.dataset.cat === catId) {
                        btn.className = 'cat-filter px-4 py-2 rounded-full text-sm font-bold bg-slate-800 text-white shadow transition-all';
                    } else {
                        btn.className = 'cat-filter px-4 py-2 rounded-full text-sm font-medium bg-white text-slate-600 border border-slate-200 hover:bg-slate-50 transition-all';
                    }
                });

                const listContainer = document.getElementById('method-list');
                const filtered = catId === 'all' 
                    ? dunderData.methods 
                    : dunderData.methods.filter(m => m.category === catId);

                listContainer.innerHTML = filtered.map(m => `
                    <div onclick="app.showMethodDetail('${m.name}')" class="card-hover bg-white p-4 rounded-lg border border-slate-200 cursor-pointer flex justify-between items-center group">
                        <div>
                            <span class="font-mono font-bold text-blue-600 text-lg">${m.name}</span>
                            <span class="text-slate-400 text-xs ml-2 font-mono">${m.args}</span>
                        </div>
                        <span class="text-slate-300 group-hover:text-blue-500 transition-colors">‚ûú</span>
                    </div>
                `).join('');
            },

            showMethodDetail(methodName) {
                const m = dunderData.methods.find(x => x.name === methodName);
                if (!m) return;

                const detailContainer = document.getElementById('method-detail');
                const catName = this.t(dunderData.categories.find(c => c.id === m.category).name);
                
                detailContainer.classList.remove('animate-fade-in');
                void detailContainer.offsetWidth; 
                detailContainer.classList.add('animate-fade-in');

                detailContainer.innerHTML = `
                    <div class="border-b border-slate-100 bg-slate-50 p-6">
                        <div class="flex items-baseline justify-between mb-2">
                            <h3 class="text-3xl font-mono font-bold text-blue-700">${m.name}</h3>
                            <span class="px-3 py-1 bg-blue-100 text-blue-800 text-xs rounded-full uppercase font-bold tracking-wide">${catName}</span>
                        </div>
                        <p class="text-slate-700 text-lg">${this.t(m.desc)}</p>
                    </div>
                    
                    <div class="p-6 space-y-6">
                        <div>
                            <h4 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-2">Code Example</h4>
                            <div class="bg-slate-900 rounded-lg p-4 overflow-x-auto custom-scroll">
                                <pre class="text-sm code-font text-green-400">${this.escapeHtml(m.example)}</pre>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-2">Usage</h4>
                                <div class="bg-slate-100 border border-slate-200 rounded p-3 code-font text-slate-700 text-sm">
                                    ${m.usage}
                                </div>
                            </div>
                            <div>
                                <h4 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-2">Pro Tip üí°</h4>
                                <p class="text-sm text-slate-600 bg-yellow-50 border border-yellow-100 p-3 rounded">
                                    ${this.t(m.tips)}
                                </p>
                            </div>
                        </div>
                    </div>
                `;
            },

            renderLab() {
                const controls = document.getElementById('lab-controls');
                controls.innerHTML = dunderData.labScenarios.map(scen => `
                    <button onclick="app.runLab('${scen.id}')" class="px-4 py-2 bg-white border border-slate-300 hover:border-blue-500 hover:text-blue-600 rounded shadow-sm text-sm font-medium transition-all">
                        ${this.t(scen.label)}
                    </button>
                `).join('');
                
                // Reset text if just switching lang
                const outputDisplay = document.getElementById('lab-output');
                if (!outputDisplay.innerText.includes('>_')) {
                     // preserve state or reset? Resetting is safer for text sync
                } else {
                    document.getElementById('lab-explanation').innerHTML = this.t('lab_waiting');
                }
            },

            renderInsights() {
                const list = document.getElementById('insight-list');
                list.innerHTML = dunderData.insights.map(i => `<li>${this.t(i)}</li>`).join('');
            },

            runLab(scenId) {
                const scenario = dunderData.labScenarios.find(s => s.id === scenId);
                const codeDisplay = document.getElementById('lab-code-display');
                const outputDisplay = document.getElementById('lab-output');
                const explanationDisplay = document.getElementById('lab-explanation');

                codeDisplay.innerHTML = `
                    <div class="flex gap-2 mb-4 opacity-50">
                        <span class="text-pink-400">class</span> <span class="text-yellow-300">Animal</span>: ...
                    </div>
                    <div class="pl-0 border-l-2 border-blue-500 pl-2 animate-pulse">
                        <span class="text-white">${scenario.code}</span>
                    </div>
                `;

                outputDisplay.innerHTML = `<span class="animate-pulse">${this.t('lab_processing')}</span>`;
                
                setTimeout(() => {
                    outputDisplay.innerHTML = this.t('lab_done');
                    explanationDisplay.innerHTML = `
                        <div class="space-y-3 animate-fade-in">
                            <div>
                                <strong class="block text-slate-900 mb-1">Python Internal:</strong>
                                <code class="bg-slate-200 px-2 py-1 rounded text-pink-600 font-mono text-sm block w-full overflow-x-auto">${scenario.internal}</code>
                            </div>
                            <p class="text-slate-600 border-t border-blue-200 pt-2 mt-2">${this.t(scenario.desc)}</p>
                        </div>
                    `;
                }, 400);
            },

            initCharts() {
                // Destroy existing charts to allow language update
                if (this.charts.intro) this.charts.intro.destroy();
                if (this.charts.usage) this.charts.usage.destroy();
                if (this.charts.radar) this.charts.radar.destroy();

                // Chart 1: Intro Benefit
                const ctxIntro = document.getElementById('introChart').getContext('2d');
                this.charts.intro = new Chart(ctxIntro, {
                    type: 'bar',
                    data: {
                        labels: [this.t('lbl_readability'), this.t('lbl_flexibility'), this.t('lbl_compatibility')],
                        datasets: [{
                            label: this.t('lbl_score'),
                            data: [85, 90, 95],
                            backgroundColor: ['#3b82f6', '#8b5cf6', '#10b981'],
                            borderRadius: 6
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: { y: { beginAtZero: true, max: 100, display: false }, x: { grid: { display: false } } }
                    }
                });

                // Chart 2: Usage
                const ctxUsage = document.getElementById('usageChart').getContext('2d');
                this.charts.usage = new Chart(ctxUsage, {
                    type: 'bar',
                    data: {
                        labels: ['__init__', '__str__', '__len__', '__getitem__', '__add__', '__enter__'],
                        datasets: [{
                            label: this.t('lbl_freq'),
                            data: [98, 75, 45, 40, 15, 25],
                            backgroundColor: '#3b82f6',
                            borderRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: { y: { beginAtZero: true, max: 100 } }
                    }
                });

                // Chart 3: Radar
                const ctxRadar = document.getElementById('radarChart').getContext('2d');
                this.charts.radar = new Chart(ctxRadar, {
                    type: 'radar',
                    data: {
                        labels: ['Init', 'Math', 'Index', 'Context', 'Compare'],
                        datasets: [{
                            label: this.t('lbl_complexity'),
                            data: [20, 60, 50, 40, 30],
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.2)',
                            pointBackgroundColor: '#ef4444'
                        }, {
                            label: this.t('lbl_utility'),
                            data: [100, 30, 70, 60, 50],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.2)',
                            pointBackgroundColor: '#3b82f6'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                angleLines: { color: '#e2e8f0' },
                                grid: { color: '#e2e8f0' },
                                pointLabels: { font: { size: 12, family: "'Inter', sans-serif" } },
                                suggestedMin: 0,
                                suggestedMax: 100
                            }
                        }
                    }
                });
            },
            
            escapeHtml(text) {
                return text.replace(/&/g, "&amp;")
                           .replace(/</g, "&lt;")
                           .replace(/>/g, "&gt;")
                           .replace(/"/g, "&quot;")
                           .replace(/'/g, "&#039;");
            }
        };

        // Initialize App
        document.addEventListener('DOMContentLoaded', () => {
            app.init();
        });

    </script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
    </style>
</body>
</html>
